"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[6387],{3905:(e,t,a)=>{a.d(t,{Zo:()=>p,kt:()=>m});var o=a(67294);function s(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,o)}return a}function n(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){s(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,o,s=function(e,t){if(null==e)return{};var a,o,s={},r=Object.keys(e);for(o=0;o<r.length;o++)a=r[o],t.indexOf(a)>=0||(s[a]=e[a]);return s}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)a=r[o],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(s[a]=e[a])}return s}var l=o.createContext({}),c=function(e){var t=o.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):n(n({},t),e)),a},p=function(e){var t=c(e.components);return o.createElement(l.Provider,{value:t},e.children)},g="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},d=o.forwardRef((function(e,t){var a=e.components,s=e.mdxType,r=e.originalType,l=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),g=c(a),d=s,m=g["".concat(l,".").concat(d)]||g[d]||u[d]||r;return a?o.createElement(m,n(n({ref:t},p),{},{components:a})):o.createElement(m,n({ref:t},p))}));function m(e,t){var a=arguments,s=t&&t.mdxType;if("string"==typeof e||s){var r=a.length,n=new Array(r);n[0]=d;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i[g]="string"==typeof e?e:s,n[1]=i;for(var c=2;c<r;c++)n[c]=a[c];return o.createElement.apply(null,n)}return o.createElement.apply(null,a)}d.displayName="MDXCreateElement"},16384:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>n,default:()=>u,frontMatter:()=>r,metadata:()=>i,toc:()=>c});var o=a(87462),s=(a(67294),a(3905));const r={slug:"tembo-stacks-intro",title:"Tembo Stacks: Making Postgres the Everything Database",authors:["samay"],tags:["postgres","tembo"]},n="Evolution of Postgres",i={permalink:"/blog/tembo-stacks-intro",editUrl:"https://github.com/tembo-io/website/blob/main/blog/2023-09-06-tembo-stacks/index.md",source:"@site/blog/2023-09-06-tembo-stacks/index.md",title:"Tembo Stacks: Making Postgres the Everything Database",description:"For years, Postgres has been considered among the most popular and advanced open source OLTP databases. Interestingly, 20 years ago, it was a competition between Postgres and MySQL and this debate is still going on today. \ud83d\ude42 Over the last few years, Postgres added more features and its ecosystem added more extensions and now the comparison list keeps growing. After adding support for jsonb in 9.4, Postgres began to be compared with MongoDB as users started using Postgres to store unstructured data. With Citus, people started using Postgres over other distributed SQL technologies for use cases such as multi-tenancy and analytics. And this phenomenon continues to grow with pgvector, timescaledb and others.",date:"2023-09-06T00:00:00.000Z",formattedDate:"September 6, 2023",tags:[{label:"postgres",permalink:"/blog/tags/postgres"},{label:"tembo",permalink:"/blog/tags/tembo"}],readingTime:5.01,hasTruncateMarker:!1,authors:[{name:"Samay Sharma",title:"CTO Tembo",url:"https://github.com/samay-sharma",email:"noreply@tembo.io",imageURL:"https://github.com/samay-sharma.png",key:"samay"}],frontMatter:{slug:"tembo-stacks-intro",title:"Tembo Stacks: Making Postgres the Everything Database",authors:["samay"],tags:["postgres","tembo"]},prevItem:{title:"Enter the matrix: the four types of Postgres extensions",permalink:"/blog/four-types-of-extensions"},nextItem:{title:"Optimizing Postgres's Autovacuum for High-Churn Tables",permalink:"/blog/optimizing-postgres-auto-vacuum"}},l={authorsImageUrls:[void 0]},c=[{value:"Making \u201cPostgres for Everything\u201d real",id:"making-postgres-for-everything-real",level:2},{value:"Defining a stack",id:"defining-a-stack",level:2},{value:"Deploying a stack on Tembo Cloud",id:"deploying-a-stack-on-tembo-cloud",level:2}],p={toc:c},g="wrapper";function u(e){let{components:t,...r}=e;return(0,s.kt)(g,(0,o.Z)({},p,r,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("p",null,"For years, Postgres has been considered among the most popular and advanced open source OLTP databases. Interestingly, 20 years ago, it was a competition between Postgres and MySQL and this debate is still going on ",(0,s.kt)("a",{parentName:"p",href:"https://news.ycombinator.com/item?id=35906604"},"today"),". \ud83d\ude42 Over the last few years, Postgres added more features and its ecosystem added more extensions and now the comparison list keeps growing. After adding support for ",(0,s.kt)("a",{parentName:"p",href:"https://www.postgresql.org/docs/release/9.4.0/"},"jsonb")," in 9.4, Postgres began to be compared with MongoDB as users started using Postgres to store unstructured data. With ",(0,s.kt)("a",{parentName:"p",href:"https://github.com/citusdata/citus"},"Citus"),", people started using Postgres over other distributed SQL technologies for use cases such as multi-tenancy and analytics. And this phenomenon continues to grow with ",(0,s.kt)("a",{parentName:"p",href:"https://github.com/pgvector/pgvector"},"pgvector"),", ",(0,s.kt)("a",{parentName:"p",href:"https://github.com/timescale/timescaledb"},"timescaledb")," and others."),(0,s.kt)("h1",{id:"use-postgres-for-everything"},"Use Postgres for Everything"),(0,s.kt)("p",null,"Postgres has evolved to where people have started talking about using \u201cPostgres for everything.\u201d There\u2019s strong agreement that it\u2019s wise to use Postgres until you find a strong reason for why you can\u2019t use it anymore - either a very specialized use case, or scale which can\u2019t be achieved by Postgres. This topic was well-discussed on ",(0,s.kt)("a",{parentName:"p",href:"https://news.ycombinator.com/item?id=33934139"},"hacker news")," thanks to a ",(0,s.kt)("a",{parentName:"p",href:"https://www.amazingcto.com/postgres-for-everything/"},"blog")," by a friend, Steven Schmidt."),(0,s.kt)("p",null,"And to clarify, when I say Postgres, I mean the entire Postgres ecosystem - this includes Postgres, its extensions and ecosystem tooling for high-availabilty, backups, connection pooling, etc. All of these together turn Postgres into a powerful data platform which you can use to run diverse workloads. However, it\u2019s easier said than done."),(0,s.kt)("h2",{id:"making-postgres-for-everything-real"},"Making \u201cPostgres for Everything\u201d real"),(0,s.kt)("p",null,"Advanced users may know the recipe which turns Postgres into a distributed database, a vector database, an OLAP database or a search store, but this is still inaccessible to most developers. Over years of working with Postgres users, I\u2019ve realized that even tuning Postgres for OLTP (which is a fairly well known use case) is very hard for most developers. For example: OLTP deployments often have badly chosen indexes, over / under provisioned hardware, insufficiently tuned autovacuum etc. even though they are running on managed services which do the heavy lifting for them."),(0,s.kt)("p",null,"So, expecting developers to be able to figure out how to use Postgres for all these use cases when there are other databases focused on user experience for one particular use case is unrealistic. Even though developers know that dealing with 5 different databases is a pain in the medium to long run, when they are starting, they care about getting off the ground fast. So, to expect everybody to use Postgres for everything, we need to make it possible for every user to have easy access to the recipes which turn Postgres into the database for the data service of their choice."),(0,s.kt)("h1",{id:"enter-tembo-stacks"},"Enter Tembo Stacks"),(0,s.kt)("p",null,"Tembo stacks are pre-built use-case-specific Postgres deployments which are optimized and tuned to serve a specific workload. They aim to be a replacement for other databases which you actually don\u2019t need, but you are considering because you don\u2019t know how to solve that problem using Postgres. They help you avoid the pains associated with learning, managing and deploying other database systems. Some examples of Stacks are: OLTP, Message Queue, Data Warehouse, Enterprise LLM and Document Store."),(0,s.kt)("h2",{id:"defining-a-stack"},"Defining a stack"),(0,s.kt)("p",null,"A stack is a recipe of how to run an optimized Postgres for a workload, expressed as a spec file. The spec includes the following components:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Docker Base Image containing a particular version of Postgres"),(0,s.kt)("li",{parentName:"ul"},"Curated set of extensions which turn Postgres into best-in-class for that workload."),(0,s.kt)("li",{parentName:"ul"},"Hardware profile which is best suited for that workload"),(0,s.kt)("li",{parentName:"ul"},"Postgres configs optimized according to hardware and workload"),(0,s.kt)("li",{parentName:"ul"},"Use-case specific metrics, alerts and recommendations"),(0,s.kt)("li",{parentName:"ul"},"On-instance sidecar - Kubernetes Services to Deploy a containerized application near Postgres to expand capabilities while minimizing network latency")),(0,s.kt)("p",null,"Let\u2019s look at an example of a stack spec for a ",(0,s.kt)("a",{parentName:"p",href:"https://github.com/tembo-io/tembo-stacks/blob/main/tembo-operator/src/stacks/templates/message_queue.yaml"},"Message queue")," stack - an ",(0,s.kt)("a",{parentName:"p",href:"https://aws.amazon.com/sqs/"},"SQS")," / ",(0,s.kt)("a",{parentName:"p",href:"https://www.rabbitmq.com/"},"RabbitMQ")," replacement based on Postgres."),(0,s.kt)("p",null,"It has the following components:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"A standard Postgres 15 base image"),(0,s.kt)("li",{parentName:"ul"},"Curated extensions: ",(0,s.kt)("a",{parentName:"li",href:"https://github.com/tembo-io/pgmq"},"pgmq"),", ",(0,s.kt)("a",{parentName:"li",href:"https://github.com/pgpartman/pg_partman"},"pg_partman")," and ",(0,s.kt)("a",{parentName:"li",href:"https://www.postgresql.org/docs/current/pgstatstatements.html"},"pg_stat_statements")),(0,s.kt)("li",{parentName:"ul"},"Optimized Postgres configs: Aggressive autovacuum settings, reduced random_page_cost and Checkpoint and WAL configs tuned for a high throughput Postgres instance"),(0,s.kt)("li",{parentName:"ul"},"CPU::Memory ratio recommendations for hardware"),(0,s.kt)("li",{parentName:"ul"},"Message queue specific metrics like queue length, oldest message age, newest message age"),(0,s.kt)("li",{parentName:"ul"},"(Coming soon) pg_bouncer")),(0,s.kt)("p",null,"This and many other such stack specifications are ",(0,s.kt)("a",{parentName:"p",href:"https://github.com/tembo-io/tembo-stacks/tree/main/tembo-operator/src/stacks/templates"},"open source")," and can be used to deploy a stack locally on a self-managed instance or fully managed on Tembo Cloud. This is a reflection of one of our core values - to always put developers first. We open source our stacks to create the best development experience: locally and on the cloud, and to invite community feedback and collaboration."),(0,s.kt)("h2",{id:"deploying-a-stack-on-tembo-cloud"},"Deploying a stack on Tembo Cloud"),(0,s.kt)("p",null,(0,s.kt)("a",{parentName:"p",href:"https://cloud.tembo.io/"},"Tembo Cloud")," is a dev-first, fully-extensible, fully-managed, secure, and scalable Postgres service. It has the ability to take this stack spec and deploy a Postgres instance which is built using this stack spec. With Tembo Cloud, you can get all the benefits of a managed service like: backups, high availability, scaling of storage and compute, metrics and alerts with an easy to use UI and CLI. And you get access to an ever growing list of ",(0,s.kt)("a",{parentName:"p",href:"https://pgt.dev/"},"extensions")," which you can add to your stack or bring your own extensions to deploy on Tembo Cloud."),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"image",src:a(87943).Z,width:"2920",height:"2076"})),(0,s.kt)("h1",{id:"evolving-postgres-to-be-the-data-platform-for-everything"},"Evolving Postgres to be the data platform for everything"),(0,s.kt)("p",null,"We know we\u2019ve embarked on a challenging journey to turn Postgres into the data platform for Everything. But, we strongly believe that with the power of Postgres and its ecosystem, it\u2019s possible to replace most deployments of esoteric databases with just a flavor of Postgres and save developers a lot of time and effort."),(0,s.kt)("p",null,"We\u2019ll be building many stacks, benchmarking them against \u201ccompetitive\u201d solutions, and making sure Postgres grows to tackle these workloads. We\u2019ll have to optimize Postgres, support a wide variety of extensions, write several new extensions to close feature and performance gaps with other databases and also evolve Postgres. But, we have no doubt that we, along with the Postgres community can make this happen!"))}u.isMDXComponent=!0},87943:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/image-cae704f1f54958b9c0cff9d1ea5cb41d.png"}}]);