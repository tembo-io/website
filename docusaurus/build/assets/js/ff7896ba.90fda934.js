"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[1259],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>h});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},s=Object.keys(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var c=a.createContext({}),l=function(e){var t=a.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=l(e.components);return a.createElement(c.Provider,{value:t},e.children)},d="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,s=e.originalType,c=e.parentName,u=o(e,["components","mdxType","originalType","parentName"]),d=l(n),m=r,h=d["".concat(c,".").concat(m)]||d[m]||p[m]||s;return n?a.createElement(h,i(i({ref:t},u),{},{components:n})):a.createElement(h,i({ref:t},u))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var s=n.length,i=new Array(s);i[0]=m;var o={};for(var c in t)hasOwnProperty.call(t,c)&&(o[c]=t[c]);o.originalType=e,o[d]="string"==typeof e?e:r,i[1]=o;for(var l=2;l<s;l++)i[l]=n[l];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},9204:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>i,default:()=>p,frontMatter:()=>s,metadata:()=>o,toc:()=>l});var a=n(87462),r=(n(67294),n(3905));const s={sidebar_position:1,tags:["security"]},i="Security",o={unversionedId:"tembo-cloud/security-and-authentication/security",id:"tembo-cloud/security-and-authentication/security",title:"Security",description:"Please report security issues by emailing security@tembo.io",source:"@site/docs/tembo-cloud/security-and-authentication/security.md",sourceDirName:"tembo-cloud/security-and-authentication",slug:"/tembo-cloud/security-and-authentication/security",permalink:"/docs/tembo-cloud/security-and-authentication/security",draft:!1,editUrl:"https://github.com/tembo-io/website/blob/main/docs/tembo-cloud/security-and-authentication/security.md",tags:[{label:"security",permalink:"/docs/tags/security"}],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1,tags:["security"]},sidebar:"tutorialSidebar",previous:{title:"Security and Authentication",permalink:"/docs/category/security-and-authentication"},next:{title:"API Authentication",permalink:"/docs/tembo-cloud/security-and-authentication/api-authentication"}},c={},l=[{value:"User permissions",id:"user-permissions",level:2},{value:"Tenant isolation",id:"tenant-isolation",level:2},{value:"Data storage",id:"data-storage",level:2},{value:"Network connections",id:"network-connections",level:2},{value:"SSL and certificates",id:"ssl-and-certificates",level:3},{value:"Need stronger isolation?",id:"need-stronger-isolation",level:2}],u={toc:l},d="wrapper";function p(e){let{components:t,...n}=e;return(0,r.kt)(d,(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"security"},"Security"),(0,r.kt)("p",null,"Please report security issues by emailing ",(0,r.kt)("a",{parentName:"p",href:"mailto:security@tembo.io"},"security@tembo.io")),(0,r.kt)("h2",{id:"user-permissions"},"User permissions"),(0,r.kt)("p",null,"In the Tembo Cloud security model, end users are permitted arbitrary code execution as a non-root user within their server."),(0,r.kt)("p",null,"Users are allowed to access the Postgres superuser, perform actions that are not typically allowed in other cloud providers like ",(0,r.kt)("inlineCode",{parentName:"p"},"COPY FROM PROGRAM"),", and execute arbitrary code with Postgres extensions. Tembo Cloud does not attempt to limit users from escaping Postgres security controls by using privileges associated with Postgres superuser, but also we provide a less-privileged user as an option. Security isolation is performed using network policies and containers. The relevant configurations for tenant isolation are open source."),(0,r.kt)("h2",{id:"tenant-isolation"},"Tenant isolation"),(0,r.kt)("p",null,"Postgres workloads are running on shared compute infrastructure."),(0,r.kt)("p",null,"Compute isolation is handled with containers. To address container escape attacks, Tembo Cloud does not allow root and drops all Linux capabilities from the container using Kubernetes security policies."),(0,r.kt)("p",null,"Kubernetes Pod configuration excerpt:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"securityContext:\n  allowPrivilegeEscalation: false\n  capabilities:\n    drop:\n      - ALL\n  privileged: false\n  readOnlyRootFilesystem: true\n  runAsNonRoot: true\n")),(0,r.kt)("p",null,"Network isolation is handled with Kubernetes network policies, which are handled by ",(0,r.kt)("a",{parentName:"p",href:"https://docs.tigera.io/calico/latest/reference/installation/api"},"Calico"),". Each server is in an isolated namespace, with a default deny-all network policy. Network access is permitted on a case-by-case basis, and the configurations are open source in ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/tembo-io/tembo-stacks/blob/main/tembo-operator/src/network_policies.rs"},"this file"),"."),(0,r.kt)("h2",{id:"data-storage"},"Data storage"),(0,r.kt)("p",null,"For instances deployed to an Amazon Web Services (AWS) region, the data and extensions of each instance are stored in a dedicated Elastic Block Storage volume (EBS gp3). The volumes are encrypted with ",(0,r.kt)("a",{parentName:"p",href:"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html"},"AES-256 using AWS-managed keys"),"."),(0,r.kt)("h2",{id:"network-connections"},"Network connections"),(0,r.kt)("p",null,"Postgres connections are encrypted and authenticated inside each customer's database. When an end user connects to their Tembo Cloud instance, they are establishing an encrypted TLS session with their Postgres server. There is no part of the network that decrypts the user's connections, and connections are routed into the correct database using ",(0,r.kt)("a",{parentName:"p",href:"https://https.cio.gov/sni/"},"Server Name Indication"),", which is an extension of TLS that allows for routing connections to different hosts without decrypting the traffic. Likewise, username / password authentication to Postgres is performed in the customer's database."),(0,r.kt)("h3",{id:"ssl-and-certificates"},"SSL and certificates"),(0,r.kt)("p",null,"Tembo Cloud supports ",(0,r.kt)("a",{parentName:"p",href:"https://www.postgresql.org/docs/current/libpq-ssl.html"},"Postgres Connection sslmode")," ",(0,r.kt)("inlineCode",{parentName:"p"},"require"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"verify-ca"),", and ",(0,r.kt)("inlineCode",{parentName:"p"},"verify-full"),". Users cannot connect to their database without using encryption. For a guide on how to connect with these modes, please see the ",(0,r.kt)("a",{parentName:"p",href:"/docs/tembo-cloud/security-and-authentication/connecting-with-stronger-sslmode"},"Tembo sslmode documentation"),"."),(0,r.kt)("p",null,"Tembo uses a self-signed certificate authority (CA) to issue unique certificates for each Tembo Instance. The CA is managed with ",(0,r.kt)("a",{parentName:"p",href:"https://cert-manager.io/"},"cert-manager"),". All Tembo Instances are issued unique certificates with no wildcard domains. A self-signed CA is used instead of a publicly trusted CA so that Tembo can manage the CA used to sign leaf certificates for each Tembo Instance, allowing for scalable certificate management. Public CAs will not issue leaf certificates quickly enough or in high enough volume to allow for a platform-as-a-service use case, where each database will have unique certificates."),(0,r.kt)("p",null,"The certificate infrastructure is configured like this:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"---\napiVersion: cert-manager.io/v1\nkind: ClusterIssuer\nmetadata:\n  name: selfsigning-postgres-ca-issuer\nspec:\n  selfSigned: {}\n---\napiVersion: cert-manager.io/v1\nkind: Certificate\nmetadata:\n  name: postgres-selfsigned-ca\n  namespace: cert-manager\nspec:\n  commonName: data-1.use1.tembo.io\n  subject:\n    organizations:\n      - tembo\n    organizationalUnits:\n      - engineering\n  dnsNames:\n    - data-1.use1.coredb.io\n    - data-1.use1.tembo.io\n  isCA: true\n  issuerRef:\n    group: cert-manager.io\n    kind: ClusterIssuer\n    name: selfsigning-postgres-ca-issuer\n  privateKey:\n    algorithm: ECDSA\n    size: 256\n  secretName: postgres-ca-secret\n---\napiVersion: cert-manager.io/v1\nkind: ClusterIssuer\nmetadata:\n  name: postgres-server-issuer\nspec:\n  ca:\n    secretName: postgres-ca-secret\n")),(0,r.kt)("p",null,"Above, we use a self-signed ClusterIssuer to create a self-signed CA Certificate. Then, another ClusterIssuer is created to issue certificates for Tembo Instances using that CA."),(0,r.kt)("p",null,"Each tembo instance will have certificates created, for example like this:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"---\napiVersion: cert-manager.io/v1\nkind: Certificate\nmetadata:\n  name: instance-name\n  namespace: namespace\nspec:\n  dnsNames:\n    - instance-name.data-1.use1.tembo.io\n    - instance-name-rw\n    - instance-name-rw.namespace\n    - instance-name-rw.namespace.svc\n    - instance-name-r\n    - instance-name-r.namespace\n    - instance-name-r.namespace.svc\n    - instance-name-ro\n    - instance-name-ro.namespace\n    - instance-name-ro.namespace.svc\n    - instance-name-rw\n  issuerRef:\n    group: cert-manager.io\n    kind: ClusterIssuer\n    name: postgres-server-issuer\n  secretName: ...\n---\napiVersion: cert-manager.io/v1\nkind: Certificate\nmetadata:\n  name: instance-name\n  namespace: namespace\nspec:\n  commonName: streaming_replica\n  issuerRef:\n    group: cert-manager.io\n    kind: ClusterIssuer\n    name: postgres-server-issuer\n  secretName: ...\n")),(0,r.kt)("p",null,"The code to issue certificates is open source in ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/tembo-io/tembo-stacks"},"this GitHub repository"),"."),(0,r.kt)("h2",{id:"need-stronger-isolation"},"Need stronger isolation?"),(0,r.kt)("p",null,"Tembo Cloud is designed to allow for end users to host their own Tembo Cloud ",(0,r.kt)("em",{parentName:"p"},"data plane")," on premise or in any cloud. In this model, end users can manage their databases using the Tembo Cloud UI or API in the normal way, while the system hosting their Postgres servers (the ",(0,r.kt)("em",{parentName:"p"},"data plane"),") can live anywhere. The ",(0,r.kt)("em",{parentName:"p"},"data plane")," only requires egress network access to Tembo Cloud, and Tembo Cloud does not need network access to any ",(0,r.kt)("em",{parentName:"p"},"data plane"),". ",(0,r.kt)("em",{parentName:"p"},"Data planes")," subscribe to Tembo Cloud in order to synchronize their configurations with Tembo Cloud (for example, deploying new instances, installing extensions, and so on), and the ",(0,r.kt)("em",{parentName:"p"},"data plane")," only reports back non-sensitive information like CPU, memory, health status, and so on to Tembo Cloud. Sensitive information like metrics, logs, and database passwords are retrieved by end users directly from the data plane, creating a seamless experience for any users with access to the private network. For example, if you are looking at metrics in Tembo Cloud, those metrics are being fetched by your browser from the ",(0,r.kt)("em",{parentName:"p"},"data plane"),", not from Tembo Cloud. This model allows for a seamless experience while retaining an option for users who need complete control of their data."),(0,r.kt)("p",null,"Please reach out to customer support if you are interested in a dedicated or self-hosted ",(0,r.kt)("em",{parentName:"p"},"data plane"),"."))}p.isMDXComponent=!0}}]);