"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[2695],{3905:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>h});var r=a(67294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var l=r.createContext({}),p=function(e){var t=r.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):s(s({},t),e)),a},c=function(e){var t=p(e.components);return r.createElement(l.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var a=e.components,n=e.mdxType,o=e.originalType,l=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),u=p(a),m=n,h=u["".concat(l,".").concat(m)]||u[m]||d[m]||o;return a?r.createElement(h,s(s({ref:t},c),{},{components:a})):r.createElement(h,s({ref:t},c))}));function h(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=a.length,s=new Array(o);s[0]=m;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i[u]="string"==typeof e?e:n,s[1]=i;for(var p=2;p<o;p++)s[p]=a[p];return r.createElement.apply(null,s)}return r.createElement.apply(null,a)}m.displayName="MDXCreateElement"},33822:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>g,contentTitle:()=>m,default:()=>w,frontMatter:()=>d,metadata:()=>h,toc:()=>y});var r=a(87462),n=(a(67294),a(3905));const o=a.p+"assets/images/add-element-to-array-d9d7b4958e564cec6f47aafc3fe7de2e.png",s=a.p+"assets/images/remove-element-from-array-3c1a82ca2a1b440eca2b56e5f05691a2.png",i=a.p+"assets/images/array-length-d9e36c147b13774b9dd05d030baccb43.png",l=a.p+"assets/images/array-cat-19863f475a9a162ca05af8bb1aaf37a2.png",p=a.p+"assets/images/array-dims-e84bd970baaa047d211a177efd18bdba.png",c=a.p+"assets/images/select-element-from-array-6a7a5bc61d9e11b00cd7da4a96528def.png",u=a.p+"assets/images/where-clause-in-array-3881f1aac45d3e015a487ecc32487fd7.png",d={sidebar_position:2,tags:["Postgres Basics"]},m="How to use PostgreSQL arrays",h={unversionedId:"postgres_guides/how-to-use-postgresql-arrays/how-to-use-postgresql-arrays",id:"postgres_guides/how-to-use-postgresql-arrays/how-to-use-postgresql-arrays",title:"How to use PostgreSQL arrays",description:"PostgreSQL is known for its flexibility in terms of data types. One useful, though sometimes confusing type are arrays. They enable the storage of multiple values of the same data type within a single column.",source:"@site/docs/postgres_guides/how-to-use-postgresql-arrays/how-to-use-postgresql-arrays.md",sourceDirName:"postgres_guides/how-to-use-postgresql-arrays",slug:"/postgres_guides/how-to-use-postgresql-arrays/",permalink:"/docs/postgres_guides/how-to-use-postgresql-arrays/",draft:!1,editUrl:"https://github.com/tembo-io/website/blob/main/docs/postgres_guides/how-to-use-postgresql-arrays/how-to-use-postgresql-arrays.md",tags:[{label:"Postgres Basics",permalink:"/docs/tags/postgres-basics"}],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2,tags:["Postgres Basics"]},sidebar:"tutorialSidebar",previous:{title:"How to show tables in Postgres",permalink:"/docs/postgres_guides/how-to-show-tables-in-postgres/"},next:{title:"How to work with matrices in Postgres",permalink:"/docs/postgres_guides/how-to-work-with-matrices-in-postgres/"}},g={},y=[{value:"Array Functions in Postgres",id:"array-functions-in-postgres",level:2},{value:"Conclusion",id:"conclusion",level:2}],f={toc:y},k="wrapper";function w(e){let{components:t,...a}=e;return(0,n.kt)(k,(0,r.Z)({},f,a,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"how-to-use-postgresql-arrays"},"How to use PostgreSQL arrays"),(0,n.kt)("p",null,"PostgreSQL is known for its flexibility in terms of data types. One useful, though sometimes confusing type are arrays. They enable the storage of multiple values of the same data type within a single column."),(0,n.kt)("p",null,"One ideal use case for array data types is the storage of vectors. Perhaps you need to store geographic data, or vector embeddings for similarity searches in your database (check out our ",(0,n.kt)("a",{parentName:"p",href:"https://tembo.io/blog/pgvector-and-embedding-solutions-with-postgres"},"blog post")," on vector embeddings)."),(0,n.kt)("p",null,"Let\u2019s see how you can create and use an array-typed column:"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Step 1")," - Creating a table with an array column. For the array column, you can use the square brackets '[]' immediately after specifying the data type for the array, just like this:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"CREATE TABLE students(\n    id integer PRIMARY KEY,\n    name VARCHAR(30),\n    age integer,\n    home_coordinates REAL[]\n);\n")),(0,n.kt)("p",null,"In this example, the ",(0,n.kt)("inlineCode",{parentName:"p"},"home_coordinates")," array does not have any fixed length and you can insert as many values in it as you want. You can also set limits for the array by specifying its maximum length in between the square brackets:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"CREATE TABLE students(\n    id integer PRIMARY KEY,\n    name VARCHAR(30),\n    age integer,\n    home_coordinates REAL[2]\n);\n")),(0,n.kt)("p",null,"In this example, the ",(0,n.kt)("inlineCode",{parentName:"p"},"home_coordinates")," column will store an array of maximum length 2, as this is the number of dimensions needed to represent points in geographic systems."),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Step 2")," - Now, you insert the array values in the column. Postgres has two different methods to insert array values:"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Using ",(0,n.kt)("inlineCode",{parentName:"strong"},"ARRAY")," constructor")),(0,n.kt)("p",null,"Postgres comes with an ",(0,n.kt)("inlineCode",{parentName:"p"},"ARRAY")," constructor that can be initialized in the SQL query to insert the array values into the table:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"INSERT INTO students (id, name, age, home_coordinates) VALUES (1, 'John', 15, ARRAY[40.7, 74.0]);\n")),(0,n.kt)("p",null,"Learn more about ",(0,n.kt)("inlineCode",{parentName:"p"},"ARRAY")," constructor on their ",(0,n.kt)("a",{parentName:"p",href:"https://www.postgresql.org/docs/current/sql-expressions.html#SQL-SYNTAX-ARRAY-CONSTRUCTORS"},"official website"),"."),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Directly inserting values")),(0,n.kt)("p",null,"You can also use braces to represent an array:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"INSERT INTO students (id, name, age, home_coordinates) VALUES (1, 'John', 15, {40.7, 74.0});\n")),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Step 3")," - You can query the data from the array column and display it. Postgres also comes with a way to fetch specific data from the whole array and showcase it."),(0,n.kt)("p",null,"Specify the element number along with the column name that you want to fetch. Following command will display the first element of ",(0,n.kt)("inlineCode",{parentName:"p"},"home_coordinates")," array:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"SELECT home_coordinates[1] FROM students;\n")),(0,n.kt)("img",{src:c,width:"600",alt:"SelectElement"}),(0,n.kt)("p",null,"You can also specify a ",(0,n.kt)("inlineCode",{parentName:"p"},"WHERE")," clause condition in the query. Following command will display the whole row where the latitude or longitude of a home is above 40 degrees:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"SELECT * FROM students WHERE 40 < ANY (home_coordinates);\n")),(0,n.kt)("img",{src:u,width:"600",alt:"WhereClause"}),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Step 4")," - There are also methods to manipulate or update the data in the array. You can use the traditional ",(0,n.kt)("inlineCode",{parentName:"p"},"UPDATE")," statement to update the data:"),(0,n.kt)("p",null,(0,n.kt)("inlineCode",{parentName:"p"},"UPDATE")," statement can be used to remove element(s) from the array. To remove the value ",(0,n.kt)("inlineCode",{parentName:"p"},"74.0")," from the array, execute the following command:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"}," UPDATE students SET home_coordinates = array_remove(home_coordinates, 74.0);\n")),(0,n.kt)("img",{src:s,width:"700",alt:"RemoveElement"}),(0,n.kt)("p",null,"It can then be used to append data to the array. To add the value ",(0,n.kt)("inlineCode",{parentName:"p"},"80.0")," at the end of ",(0,n.kt)("inlineCode",{parentName:"p"},"home_coordinates")," array, execute the following command:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"UPDATE students SET home_coordinates = home_coordinates || ARRAY[80.0];\n")),(0,n.kt)("img",{src:o,width:"700",alt:"AddElement"}),(0,n.kt)("h2",{id:"array-functions-in-postgres"},"Array Functions in Postgres"),(0,n.kt)("p",null,"PostgreSQL offers a range of utilities to manage arrays. Some of these popular array functions are ",(0,n.kt)("inlineCode",{parentName:"p"},"array_cat"),", ",(0,n.kt)("inlineCode",{parentName:"p"},"array_dims"),", ",(0,n.kt)("inlineCode",{parentName:"p"},"array_length"),", etc."),(0,n.kt)("p",null,(0,n.kt)("inlineCode",{parentName:"p"},"array_cat")," function concatenates or merges multiple arrays and returns the merged array:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"SELECT array_cat(array[1, 2], array[3, 4]);\n")),(0,n.kt)("img",{src:l,width:"600",alt:"ArrayCat"}),(0,n.kt)("p",null,(0,n.kt)("inlineCode",{parentName:"p"},"array_dims")," function returns the dimensions of an array:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"SELECT array_dims(array[[1, 2, 3], [4, 5, 6]]);\n")),(0,n.kt)("img",{src:p,width:"600",alt:"ArrayDims"}),(0,n.kt)("p",null,(0,n.kt)("inlineCode",{parentName:"p"},"array_length")," function returns the length of an array:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"}," SELECT array_length(home_coordinates, 1) AS total_coordinates FROM students;\n")),(0,n.kt)("p",null,"In this example, ",(0,n.kt)("inlineCode",{parentName:"p"},"1")," represents the dimension of the array whose length you want to calculate."),(0,n.kt)("img",{src:i,width:"700",alt:"ArrayLength"}),(0,n.kt)("p",null,"There are tons of built-in array functions available in Postgres. You can check the official ",(0,n.kt)("a",{parentName:"p",href:"https://www.postgresql.org/docs/current/functions-array.html"},"PostgreSQL documentation")," for a comprehensive list of array functions and operators."),(0,n.kt)("p",null,"To enhance query performance, especially when working with sizable arrays, it is possible to establish indexes on array columns in PostgreSQL. ",(0,n.kt)("strong",{parentName:"p"},"Gist")," (Generalized Search Tree) or ",(0,n.kt)("strong",{parentName:"p"},"GIN")," (Generalized Inverted Index) methods can be used to specify indexes on array columns."),(0,n.kt)("p",null,"Check out the official documentation of ",(0,n.kt)("a",{parentName:"p",href:"https://www.postgresql.org/docs/9.5/gist.html"},"Gist")," and ",(0,n.kt)("a",{parentName:"p",href:"https://www.postgresql.org/docs/current/gin-intro.html#:~:text=GIN%20stands%20for%20Generalized%20Inverted,appear%20within%20the%20composite%20items."},"GIN")," to learn more about them."),(0,n.kt)("h2",{id:"conclusion"},"Conclusion"),(0,n.kt)("p",null,"This guide covers working with arrays in PostgreSQL, including insertion, manipulation, and deletion. We have also discussed some widely used built-in array functions in Postgres."),(0,n.kt)("p",null,"Struggling to connect your project with Postgres database? Take a look at our organized ",(0,n.kt)("a",{parentName:"p",href:"https://tembo.io/docs/category/postgres-guides"},"guides")," for a detailed, step-by-step approach to connecting with a PostgreSQL database."))}w.isMDXComponent=!0}}]);